import os
from signatures import SIGNATURES

def search_signatures(file_path):
    with open(file_path, 'rb') as f:
        data = f.read()
        results = []
        for sig, file_type in SIGNATURES.items():
            offset = data.find(sig)
            if offset != -1:
                results.append((offset, file_type, sig))
        return results

def extract_files(file_path, results, output_dir):
    with open(file_path, 'rb') as f:
        for offset, file_type, sig in results:
            f.seek(offset)
            data = f.read()
            out_file = os.path.join(output_dir, f"extracted_{offset}.{file_type}")
            with open(out_file, 'wb') as out_f:
                out_f.write(data)
            print(f"Extracted {file_type} file at offset {offset} to {out_file}")
